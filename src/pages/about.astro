---
import BaseLayout from '../layouts/BaseLayout.astro';
import Bio from '../components/Bio.astro';
import Dropdown from '../components/Dropdown.astro';
import Resume from '../content/resume.md';
import WorkHistory from '../content/work_history.md';

const title = 'About';
const description = 'About me';
const permalink = `${Astro.site.href}about`;
---

<style>
  .about-image {
    float: left;
    margin: 0 2em 2em 0;
  }
  .about p {
    font-size: 1.125rem;
    padding-top: 0.5em;
    line-height: 1.6;
  }

  /* Mobile: ensure bio/article stacks and removes floats */
  @media (max-width: 520px) {
    .about-image { float: none; margin: 0 0 1rem 0; display: block; }
    .about { padding: 0 1rem; }
    .about p { font-size: 1rem; }
  }

</style>

<BaseLayout title={title} description={description} permalink={permalink}>
  <div class="container">
    <article class="about">
      <Bio bioImgHeight='15em' bioImgWidth='15em' bioImgRadius='100%' />
      <p>
        In my free time, I like reading, playing Paradox map games, going on walks around the city, and playing with my terminal.
      </p>

      <Dropdown title="Resume" id="resume" open={Astro.url.hash === '#resume'} preview="Motivated Computer Scientist and former U.S. Air Force munitions specialist transitioning into software engineering and systems work.">
        <Resume />
      </Dropdown>

      <Dropdown title="Work History" id="work-history" open={Astro.url.hash === '#work-history'} preview="Professional experience spanning IT consulting, military munitions systems, and service industry roles with transferable skills in leadership, systems thinking, and technical documentation.">
        <WorkHistory />
      </Dropdown>
    </article>
  </div>
</BaseLayout>

<script>
  // Handle hash changes to open dropdowns
  function handleHashChange() {
    const hash = window.location.hash;
    const resumeDropdown = document.getElementById('resume');
    const workHistoryDropdown = document.getElementById('work-history');
    
    if (hash === '#resume' && resumeDropdown) {
      (resumeDropdown as HTMLDetailsElement).open = true;
    } else if (hash === '#work-history' && workHistoryDropdown) {
      (workHistoryDropdown as HTMLDetailsElement).open = true;
    }
  }

  // Check hash on page load with a small delay to ensure components are rendered
  document.addEventListener('DOMContentLoaded', () => {
    setTimeout(handleHashChange, 100);
  });
  // Listen for hash changes
  window.addEventListener('hashchange', handleHashChange);
</script>
